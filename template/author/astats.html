{% extends 'author/abase.html' %}
{% load static %}
{% block body %}
  <!-- Book Card (Horizontal) -->
  <section class="bg-white shadow-lg rounded-xl p-6 flex flex-col md:flex-row md:items-center gap-6">
    <!-- Book Cover -->
    <div class="flex-shrink-0 w-36 md:w-48">
      <img src="{% static 'images/book_cover_placeholder.jpg' %}" alt="Book Cover" class="w-full h-40 md:h-60 object-cover rounded-lg shadow-md" />
    </div>

    <!-- Book Info -->
    <div class="flex flex-col justify-between w-full">
      <h2 class="text-2xl md:text-3xl font-extrabold mb-2">{{ book.bname }}</h2>
      <p class="text-sm md:text-base text-gray-700 mb-3">{{ book.description|truncatewords:30 }}</p>

      <!-- Stats -->
      <div class="flex gap-6 text-gray-600 text-sm md:text-base">
        <span>‚ù§Ô∏è {{ book.likes }}</span>
        <span>üíó {{ book.favorites }}</span>
        <span>‚≠ê {{ book.rating }}</span>
      </div>
    </div>
  </section>

  <!-- Charts Section -->
  <section class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="bg-white shadow rounded-lg p-4">
      <h3 class="font-bold text-amber-950 mb-2 text-lg md:text-xl">Monthly Views</h3>
      <div class="w-full h-64">
        <canvas id="viewsChart"></canvas>
      </div>
    </div>
    <div class="bg-white shadow rounded-lg p-4">
      <h3 class="font-bold text-amber-950 mb-2 text-lg md:text-xl">Monthly Likes</h3>
      <div class="w-full h-64">
        <canvas id="likesChart"></canvas>
      </div>
    </div>
    <div class="bg-white shadow rounded-lg p-4">
      <h3 class="font-bold text-amber-950 mb-2 text-lg md:text-xl">Comments</h3>
      <div class="w-full h-64">
        <canvas id="commentsChart"></canvas>
      </div>
    </div>
    <div class="bg-white shadow rounded-lg p-4">
      <h3 class="font-bold text-amber-950 mb-2 text-lg md:text-xl">Subscriptions</h3>
      <div class="w-full h-64">
        <canvas id="subsChart"></canvas>
      </div>
    </div>
  </section>

  <!-- Calendar / Updates Section -->
  <section class="bg-white shadow rounded-lg p-6">
    <h3 class="font-bold text-amber-950 mb-2 text-lg md:text-xl">Recent Updates</h3>
    <div class="w-full overflow-x-auto">
      <table class="w-full text-left border-collapse">
        <thead>
          <tr class="bg-orange-100">
            <th class="py-2 px-4">Date</th>
            <th class="py-2 px-4">Chapter</th>
            <th class="py-2 px-4">Views</th>
            <th class="py-2 px-4">Likes</th>
          </tr>
        </thead>
        <tbody>
          <tr class="even:bg-orange-50">
            <td class="py-2 px-4">2025-09-01</td>
            <td class="py-2 px-4">Chapter 1</td>
            <td class="py-2 px-4">1.2K</td>
            <td class="py-2 px-4">300</td>
          </tr>
          <tr class="even:bg-orange-50">
            <td class="py-2 px-4">2025-09-02</td>
            <td class="py-2 px-4">Chapter 2</td>
            <td class="py-2 px-4">1.5K</td>
            <td class="py-2 px-4">450</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-amber-950 text-white text-center py-4 text-sm">&copy; 2025 Signed & Stamped Publishing House</footer>

  <!-- Chart Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    const chartOptions = {
      responsive: true,
      maintainAspectRatio: false,
      animation: false,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true } }
    }
    
    const viewsCtx = document.getElementById('viewsChart').getContext('2d')
    new Chart(viewsCtx, {
      type: 'line',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{ label: 'Views', data: [120, 250, 180, 300, 270, 400, 350, 420, 500, 450, 480, 510], backgroundColor: 'rgba(251,191,36,0.2)', borderColor: 'rgba(251,191,36,1)', borderWidth: 2, fill: true, tension: 0.3, pointRadius: 4 }]
      },
      options: chartOptions
    })
    
    const likesCtx = document.getElementById('likesChart').getContext('2d')
    new Chart(likesCtx, {
      type: 'line',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{ label: 'Likes', data: [30, 45, 25, 60, 50, 80, 70, 85, 95, 100, 110, 120], backgroundColor: 'rgba(251,191,36,0.2)', borderColor: 'rgba(251,191,36,1)', borderWidth: 2, fill: true, tension: 0.3, pointRadius: 4 }]
      },
      options: chartOptions
    })
    
    const commentsCtx = document.getElementById('commentsChart').getContext('2d')
    new Chart(commentsCtx, {
      type: 'bar',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{ label: 'Comments', data: [12, 15, 10, 18, 20, 25, 22, 28, 30, 27, 32, 35], backgroundColor: 'rgba(251,191,36,0.7)', borderColor: 'rgba(251,191,36,1)', borderWidth: 1 }]
      },
      options: chartOptions
    })
    
    const subsCtx = document.getElementById('subsChart').getContext('2d')
    new Chart(subsCtx, {
      type: 'bar',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{ label: 'Subscriptions', data: [5, 8, 6, 10, 9, 12, 11, 14, 15, 13, 16, 18], backgroundColor: 'rgba(251,191,36,0.7)', borderColor: 'rgba(251,191,36,1)', borderWidth: 1 }]
      },
      options: chartOptions
    })
  </script>
{% endblock %}
